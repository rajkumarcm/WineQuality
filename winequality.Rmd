---
title: "Wine Quality"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: true
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: true
      smooth_scroll: true
  pdf_document:
    toc: yes
    toc_depth: '3'
---

<style>
body
{
  text-align: justify
}

.p
{
  margin-top:20px;
}

</style>

```{r, include=F}
knitr::opts_chunk$set(warning=F, results='hide', message=F)
```

```{r}
library(ggplot2)
library(ggExtra)
library(gridExtra)
library(ezids)
```
# Chapter 1: Introduction  

Wine is an alcoholic beverage that has been produced for over thousands of years and was originally founded in Georgia from 6000BC. The religious root the drink has, caused many to consume in the remembrance of God and this widened the trade across Europe. People consume wine also for its wonderful sweet taste and nutritious properties that are beneficial to health. While there are many types of wines, two of the most famous variants would be the Red and White versions produced mostly in the Europe. Wines that were once expensive to buy, are increasingly enjoyed by consumers around the world and the market is expected to grow annually by 7.22% (CAGR 2022-2025)[1]. Wine industries are researching different methods involved in the process of creating and selling wines at the same time retaining its quality to support its growth. Wines are sold at different price ranges depending on its quality, while the least expensive could be as low as $4, the pinnacle of wines could cost beyond $200 per bottle. Given a bottle of wine could be sold for over $200, we decided to conduct analyses to better understand what gives rise to the quality and their associated benefits by assessing publicly available dataset downloaded from UCI Machine Learning Repository.  
```{r}

wine <- read.csv(file='winequality-white.csv',
                 header=T,
                 sep=";",
                 fill=T,
                 strip.white=T,
                 blank.lines.skip=T)
cnames <- colnames(wine)
cnames_ind <- head(cnames, length(cnames)-1)
wine_ind <- wine[, cnames_ind]
```
# Chapter 2: Description of the data  

## Source Data  

The dataset contains `r nrow(wine)` instances with `r length(colnames(wine))-1` explanatory and 1 dependent variable - *quality* all of which are numerical. Also, the dataset does not appear to contain any missing field which appeared to be a good fit for the analyses. The features in the dataset represent various chemical levels associated with different quality level. A glimpse of the dataset is as follows:  

```{r, results='markup'}
show(str(wine))
```

### Acidity  



Before proceeding to the EDA or forming smart questions, it would be appropriate to first understand what each chemical is and its association to wine quality. The description for each chemical is given below:  

Chemical | Description
-------|-------
fixed.acidity| description goes here


# Chapter 4: Smart Questions



# Chapter 3: Exploratory Data Analysis

## Wine quality distribution

```{r}
# May be we should start using bar instead of histogram as this looks so ugly
ggplot(wine, aes(quality)) +
  geom_histogram(color='white', fill='red', alpha=0.5) +
  xlab('Quality') +
  ylab('Frequency rate') +
  labs('Quality distribution')
```

**Correlation between variables**
Visualizing highly correlated features
```{r, fig.width=11}
library(corrplot)
cnames_ind.new <- c('f.a', 'v.a', 'c.a', 'r.s', 'ch', 'f.s.d', 't.s.d', 'd', 'pH', 's', 'a')
cnames_ind.old <- colnames(wine_ind)
colnames(wine_ind) <- cnames_ind.new
cor <- corrplot.mixed(cor(wine_ind),
                       lower = "number", 
                       upper = "circle",
                       tl.col = "black")
```


```{r, include=F}

# pairs(wine[, cnames_ind[1:(length(cnames_ind)%/%2)]], pch=19,
#       col=wine$quality,
#       lower.panel=NULL)
```


```{r}

# Boolean indices
wine.low <- wine[, "quality"] < 5
wine.medium <- wine[, "quality"] >= 5 & wine[, "quality"] <= 7
wine.high <- wine[, "quality"] > 7

# Categorise quality into three levels for better comparison
wine$quality[wine.low] <- 1
wine$quality[wine.medium] <- 2
wine$quality[wine.high] <- 3

```


```{r fixed.acidity}

bp.fa <- ggplot(wine, aes(x=quality, y=fixed.acidity, fill=quality, group=quality)) +
          geom_boxplot(outlier.shape=8, outlier.color='red', color='white') +
          stat_boxplot(geom='errorbar', width=0.3) +
         xlab('Quality level') +
         ylab('Fixed Acidity level') +
         ggtitle('Fixed Acidity level found in different quality levels of wine')

bp.fa
```


```{r volatile.acidity}
bp.va <- ggplot(wine, aes(x=quality, y=volatile.acidity, fill=quality, group=quality)) +
          geom_boxplot(outlier.shape=8, outlier.color='red', color='white') +
          stat_boxplot(geom='errorbar', width=0.3) +
         xlab('Quality level') +
         ylab('Volatile Acidity level') +
         ggtitle('Volatile Acidity level found in different quality levels of wine')

bp.va
```

```{r citric.acidity}
bp.ca <- ggplot(wine, aes(x=quality, y=citric.acid, fill=quality, group=quality)) +
          geom_boxplot(outlier.shape=8, outlier.color='red', color='white') +
          stat_boxplot(geom='errorbar', width=0.3) +
         xlab('Quality level') +
         ylab('Citric Acid level') +
         ggtitle('Citric Acid level found in different quality levels of wine')

bp.ca
```

```{r}
bp.rs <- ggplot(wine, aes(x=quality, y=residual.sugar, fill=quality, group=quality)) +
          geom_boxplot(outlier.shape=8, outlier.color='red', color='white') +
          stat_boxplot(geom='errorbar', width=0.3) +
         xlab('Quality level') +
         ylab('Residual sugar level') +
         ggtitle('Residual sugar level found in different quality levels of wine')

bp.rs
```

```{r chloride}
bp.ch <- ggplot(wine, aes(x=quality, y=chlorides, fill=quality, group=quality)) +
          geom_boxplot(outlier.shape=8, outlier.color='red', color='white') +
          stat_boxplot(geom='errorbar', width=0.3) +
         xlab('Quality level') +
         ylab('Chloride level') +
         ggtitle('Chloride level found in different quality levels of wine')

bp.ch
```

```{r }
bp.fsd <- ggplot(wine, aes(x=quality, y=free.sulfur.dioxide, fill=quality, group=quality)) +
          geom_boxplot(outlier.shape=8, outlier.color='red', color='white') +
          stat_boxplot(geom='errorbar', width=0.3) +
          xlab('Quality level') +
          ylab('Chloride level') +
          ggtitle('Free Sulfur Dioxide level found in different quality levels of wine')

bp.fsd
```

```{r}

```