stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab(TeX('Fixed Acidity level $x 10^{3} mg/L $')) +
ggtitle("Distribution of fixed acidity in white wine")
bp.fa.red <- ggplot(redwine, aes(x=quality, y=fixed.acidity, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab(TeX('Fixed Acidity level $x 10^{3} mg/L $')) +
ggtitle("Distribution of fixed acidity in red wine")
bp.fa_wr <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=fixed.acidity, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
ggtitle('Distribution of fixed acidity in white and red')
grid.arrange(bp.fa.red, bp.fa, bp.fa_wr, nrow=1)
# bp.fa_wr
fa.aov <- aov(fixed.acidity ~ quality, data=wine)
fa.aov
summary(fa.aov)
ind_cnames <- colnames(wine)
ind_cnames <- ind_cnames[1:(length(ind_cnames)-2)]
corrplot(cor(wine.orig[, ind_cnames]),
type='upper',
method='circle')
bp.va <- ggplot(wine, aes(x=quality, y=volatile.acidity, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Volatile Acidity level') +
#ylim(0.05, 1) +
ggtitle('Volatile Acidity level in White Wine')
bp.va.red <- ggplot(redwine, aes(x=quality, y=volatile.acidity, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Volatile Acidity level') +
# ylim(0.05, 1) +
ggtitle('Volatile Acidity in Red Wine')
bp.va.red.white <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=volatile.acidity, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Volatile Acidity level') +
# ylim(0.05, 1) +
ggtitle('Volatile Acidity in Red & White')
grid.arrange(bp.va, bp.va.red, bp.va.red.white, nrow=1)
bp.ca <- ggplot(wine.grouped, aes(x=quality, y=citric.acid, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Citric Acid level') +
ggtitle('Citric Acid in White Wine')
bp.ca.red <- ggplot(redwine.grouped, aes(x=quality, y=citric.acid, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Citric Acid level') +
ggtitle('Citric Acid in Red Wine')
bp.ca.red.white <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=citric.acid, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Citric Acid level') +
ggtitle('Citric Acid in Red and White')
grid.arrange(bp.ca, bp.ca.red, bp.ca.red.white, nrow=1)
bp.ch <- ggplot(wine.grouped, aes(x=quality, y=chlorides, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Chloride level') +
ggtitle('Chloride level in White Wine')
bp.ch.red <- ggplot(redwine.grouped, aes(x=quality, y=chlorides, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Chloride level') +
ggtitle('Chloride level in Red Wine')
bp.ch.red.white <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=chlorides, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Chloride level') +
ggtitle('Chloride level in White and Red')
grid.arrange(bp.ch, bp.ch.red, bp.ch.red.white, nrow=1)
bp.density.w.quality <- ggplot(wine, aes(x=quality, y=density, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Density') +
# ylim(0.985, 1.005) +
ggtitle('Density in White Wine')
bp.density.r.quality <- ggplot(redwine, aes(x=quality, y=density, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Density') +
# ylim(0.985, 1.005) +
ggtitle('Density in Red Wine')
bp.density <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=density, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Wine Type') +
ylab('Density') +
# ylim(0.985, 1.005) +
ggtitle('How density is distributed in red and white wine')
# bp.density
grid.arrange(bp.density.w.quality, bp.density.r.quality, bp.density, nrow=1)
ggplot(wine, aes(x=alcohol, y=density, color=quality)) +
geom_point() +
ylim(0.984, 1.005)
ggtitle('How density and alcohol are correlated')
bp.sul.w <- ggplot(wine, aes(x=quality, y=sulphates, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Sulphates') +
# ylim(0.985, 1.005) +
ggtitle('Sulphates in White Wine')
bp.sul.r <- ggplot(redwine, aes(x=quality, y=sulphates, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Sulphates') +
# ylim(0.985, 1.005) +
ggtitle('Sulphates in Red Wine')
bp.sul <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=sulphates, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Wine Type') +
ylab('Sulphates') +
# ylim(0.985, 1.005) +
ggtitle('Sulphates in red and white wine')
grid.arrange(bp.sul.w, bp.sul.r, bp.sul, nrow=1)
aov.sulp <- aov(sulphates~quality, data=wine.grouped)
aov.sulp
summary(aov.sulp)
tmp_model <- lm(total.sulfur.dioxide ~ free.sulfur.dioxide, data=wine)
tmp_x <- seq(min(wine$free.sulfur.dioxide), max(wine$free.sulfur.dioxide), length.out=50)
tmp_y <- tmp_x * tmp_model$coefficients[['free.sulfur.dioxide']] + tmp_model$coefficients[['(Intercept)']]
tmp_d <- cbind(tmp_x, tmp_y)
colnames(tmp_d) <- c('free.sulfur.dioxide', 'total.sulfur.dioxide')
tmp_d <- data.frame(tmp_d)
cor.test(wine$free.sulfur.dioxide, wine$total.sulfur.dioxide)
ggplot(wine, aes(x=free.sulfur.dioxide, y=total.sulfur.dioxide)) +
geom_point(color='blue') +
geom_line(data=tmp_d, color='red') +
xlab('Free Sulfur Dioxide') +
ylab('Total Sulfur Dioxide') +
ggtitle('Correlation between Sulfur that is free and bound to other elements in wine')
tmp_model <- lm(density ~ residual.sugar, data=wine)
tmp_x <- seq(min(wine$residual.sugar), max(wine$residual.sugar), length.out=50)
tmp_y <- tmp_x * tmp_model$coefficients[['residual.sugar']] + tmp_model$coefficients[['(Intercept)']]
tmp_d <- cbind(tmp_x, tmp_y)
colnames(tmp_d) <- c('residual.sugar', 'density')
tmp_d <- data.frame(tmp_d)
cor.test(wine$residual.sugar, wine$density)
ggplot(wine, aes(x=residual.sugar, y=density)) +
geom_point(color='blue') +
geom_line(data=tmp_d, color='red') +
xlab('Residual Sugar') +
ylab('Density') +
ggtitle('Correlation between Residual sugar and Density')
aov.alcohol_winetype <- aov(alcohol~wine.type, data=wine.collated)
summary(aov.alcohol_winetype)
TukeyHSD(aov.alcohol_winetype)
aov.volatile.acidity_quality <- aov(volatile.acidity~quality, data=wine.grouped)
summary(aov.volatile.acidity_quality)
library(ltm)
alcohol_corr <- biserial.cor(wine.grouped$alcohol, wine.grouped$quality, use = c("all.obs"), level=2)
ph_corr <- biserial.cor(wine.grouped$pH, wine.grouped$quality, use=c("all.obs"), level=2)
fixed.acidity_corr <- biserial.cor(wine.grouped$fixed.acidity, wine.grouped$quality, use=c("all.obs"), level=2)
density_corr <- biserial.cor(wine.grouped$density, wine.grouped$quality, use=c("all.obs"), level=2)
sulphates_corr <- biserial.cor(wine.grouped$sulphates, wine.grouped$quality, use=c("all.obs"), level=2)
total.sulfur.dioxide_corr <- biserial.cor(wine.grouped$total.sulfur.dioxide, wine.grouped$quality, use=c("all.obs"), level=2)
free.sulfur.dioxide_corr <- biserial.cor(wine.grouped$free.sulfur.dioxide, wine.grouped$quality, use=c("all.obs"), level=2)
chlorides_corr <- biserial.cor(wine.grouped$chlorides, wine.grouped$quality, use=c("all.obs"), level=2)
residual.sugar_corr <- biserial.cor(wine.grouped$residual.sugar, wine.grouped$quality, use=c("all.obs"), level=2)
citric.acid_corr <- biserial.cor(wine.grouped$citric.acid, wine.grouped$quality, use=c("all.obs"), level=2)
volatile.acidity_corr <- biserial.cor(wine.grouped$volatile.acidity, wine.grouped$quality, use=c("all.obs"), level=2)
vars.affect.quality <- c(abs(alcohol_corr), abs(ph_corr), abs(fixed.acidity_corr), abs(density_corr), abs(sulphates_corr), abs(total.sulfur.dioxide_corr), abs(free.sulfur.dioxide_corr), abs(chlorides_corr), abs(residual.sugar_corr), abs(citric.acid_corr), abs(volatile.acidity_corr))
barplot(vars.affect.quality,
main = "Correlation with quality",
xlab = "Correlation coefficient",
ylab = "Variable",
names.arg = c("Alcohol", "pH", "F.A", "Den", "Sul", "T.S", "F.S", "Chl", "R.S", "C.A", "V.A"),
col = "azure4",
horiz = F)
abline(h=0.19, col=c('darkred'))
alcohol_corr <- biserial.cor(wine.collated.grouped$alcohol, wine.collated.grouped$wine.type, use = c("all.obs"), level=2)
ph_corr <- biserial.cor(wine.collated.grouped$pH, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
fixed.acidity_corr <- biserial.cor(wine.collated.grouped$fixed.acidity, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
density_corr <- biserial.cor(wine.collated.grouped$density, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
sulphates_corr <- biserial.cor(wine.collated.grouped$sulphates, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
total.sulfur.dioxide_corr <- biserial.cor(wine.collated.grouped$total.sulfur.dioxide, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
free.sulfur.dioxide_corr <- biserial.cor(wine.collated.grouped$free.sulfur.dioxide, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
chlorides_corr <- biserial.cor(wine.collated.grouped$chlorides, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
residual.sugar_corr <- biserial.cor(wine.collated.grouped$residual.sugar, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
citric.acid_corr <- biserial.cor(wine.collated.grouped$citric.acid, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
volatile.acidity_corr <- biserial.cor(wine.collated.grouped$volatile.acidity, wine.collated.grouped$wine.type, use=c("all.obs"), level=2)
vars.affect.winetype <- c(abs(alcohol_corr), abs(ph_corr), abs(fixed.acidity_corr), abs(density_corr), abs(sulphates_corr), abs(total.sulfur.dioxide_corr), abs(free.sulfur.dioxide_corr), abs(chlorides_corr), abs(residual.sugar_corr), abs(citric.acid_corr), abs(volatile.acidity_corr))
barplot(vars.affect.winetype,
main = "Correlation with winetype",
xlab = "Correlation coefficient",
ylab = "Variable",
names.arg = c("Alcohol", "pH", "F.A", "Den", "Sul", "T.S", "F.S", "Chl", "R.S", "C.A", "V.A"),
col = "azure4",
horiz = F)
abline(h=0.19, col=c('darkred'))
aov.density_quality <- aov(density~quality, data=wine.grouped)
summary(aov.density_quality)
TukeyHSD(aov.density_quality)
test.model <- glm(quality ~ ., data=wine.grouped[-length(colnames(wine.grouped))], family='binomial')
summary(test.model)
model1 <- glm(quality ~ alcohol, data=wine.grouped, family='binomial')
summary(model1)
model2 <- glm(quality ~ alcohol+chlorides, data=wine.grouped, family='binomial')
summary(model2)
xkablevif(model2)
model3 <- glm(quality ~ alcohol+chlorides+free.sulfur.dioxide, data=wine.grouped, family='binomial')
summary(model3)
xkablevif(model3)
model4 <- glm(quality ~ alcohol+chlorides+residual.sugar, data=wine.grouped, family='binomial')
summary(model4)
xkablevif(model4)
model5 <- glm(quality ~ alcohol+chlorides+sulphates, data=wine.grouped, family='binomial')
summary(model5)
xkablevif(model5)
model6 <- glm(quality ~ alcohol+chlorides+sulphates+pH, data=wine.grouped, family='binomial')
summary(model6)
xkablevif(model6)
bp.alc.red1 <- ggplot(redwine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', color=colors) +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in Red Wine')
bp.alc.white1 <- ggplot(wine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', color=colors) +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in White Wine')
tmp.wine.collated.grouped.good <- wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',]
bp.alc.red.white1 <- ggplot(tmp.wine.collated.grouped.good, aes(x=wine.type, y=alcohol, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', color=colors) +
xlab('Wine Type') +
ylab('Alcohol level distribution') +
ggtitle('Alcohol level in red and white wines')
grid.arrange(bp.alc.red1, bp.alc.white1, bp.alc.red.white1, nrow=1)
bp.alc.red1 <- ggplot(redwine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in Red Wine')
bp.alc.white1 <- ggplot(wine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in White Wine')
tmp.wine.collated.grouped.good <- wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',]
bp.alc.red.white1 <- ggplot(tmp.wine.collated.grouped.good, aes(x=wine.type, y=alcohol, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level distribution') +
ggtitle('Alcohol level in red and white wines')
grid.arrange(bp.alc.red1, bp.alc.white1, bp.alc.red.white1, nrow=1)
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
knitr::opts_chunk$set(warning=F, results='hide', message=F)
library(ggplot2)
library(ggExtra)
library(gridExtra)
library(ezids)
library(lattice)
library(corrplot)
library(tidyverse)
library(latex2exp)
wine.orig <- read.csv(file='winequality-white.csv',
header=T,
sep=";",
fill=T,
strip.white=T,
blank.lines.skip=T)
cnames <- colnames(wine.orig)
cnames_ind <- head(cnames, length(cnames)-1)
redwine.orig <- read.csv(file='winequality-red.csv',
header=T,
sep=";",
fill=T,
strip.white=T,
blank.lines.skip=T)
wine.orig <- outlierKD2(wine.orig, fixed.acidity, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, volatile.acidity, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, citric.acid, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, residual.sugar, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, chlorides, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, free.sulfur.dioxide, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, total.sulfur.dioxide, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, density, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, pH, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, sulphates, rm=T, histogram=F)
wine.orig <- outlierKD2(wine.orig, alcohol, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, fixed.acidity, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, volatile.acidity, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, citric.acid, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, residual.sugar, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, chlorides, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, free.sulfur.dioxide, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, total.sulfur.dioxide, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, density, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, pH, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, sulphates, rm=T, histogram=F)
redwine.orig <- outlierKD2(redwine.orig, alcohol, rm=T, histogram=F)
xkablesummary(wine.orig)
tmp.cnames <- cnames
# Let's get rid of quality for now as it would not make sense to replace them
tmp.cnames <- tmp.cnames[-length(tmp.cnames)]
for(cname in tmp.cnames)
{
tmp_median <- median(wine.orig[, cname], na.rm=T)
wine.orig[, cname] <- wine.orig[, cname] %>% replace_na(tmp_median)
}
for(cname in tmp.cnames)
{
tmp_median <- median(redwine.orig[, cname], na.rm=T)
redwine.orig[, cname] <- redwine.orig[, cname] %>% replace_na(tmp_median)
}
xkablesummary(wine.orig)
wine <- wine.orig
redwine <- redwine.orig
wine$quality <- as.factor(wine$quality)
redwine$quality <- as.factor(redwine$quality)
show(str(wine))
library(psych)
describe(wine)
wine.colnames <- colnames(wine)
wine.colnames <- c(wine.colnames, 'wine.type')
wine1 <- cbind(wine, rep('white', nrow(wine)))
colnames(wine1) <- wine.colnames
wine2 <- cbind(redwine, rep('red', nrow(redwine)))
colnames(wine2) <- wine.colnames
wine.collated <- rbind(wine1, wine2)
# May be we should start using bar instead of histogram as this looks so ugly
ggplot(wine.collated, aes(quality, fill=wine.type)) +
geom_bar(color='white', alpha=0.7) +
xlab('Quality') +
ylab('Frequency') +
labs('Quality distribution')
# , fig.width=11, fig.height=4
bp.al <- ggplot(wine, aes(x=quality, y=alcohol, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab("Alcohol level %") +
ggtitle('Alcohol level found in different quality levels of white wine')
bp.al
library(class)
# Let's remove quality column so that kmeans can handle continuous data
tmp_cnames <- colnames(wine)
tmp_cnames <- tmp_cnames[-length(tmp_cnames)]
# I don't think 1000 iterations would be required, by the way, I wanted
# a more robust clustering. Hence, I chose a really high number
# For even better clustering, we should consider using more mature
# algorithms such as GMM that clusters datapoints of different statistical
# parameter such as not just mean, but also variance.
# For now, I think this is fine.
tmp_model <- kmeans(wine[, tmp_cnames], centers=2, iter.max = 1000)
ncluster1 <- sum(tmp_model$cluster == 1)
ncluster2 <- sum(tmp_model$cluster == 2)
cluster1 <- data.frame(matrix(nrow=ncluster1, ncol=length(colnames(wine))))
cluster2 <- data.frame(matrix(nrow=ncluster2, ncol=length(colnames(wine))))
colnames(cluster1) <- cnames
colnames(cluster2) <- cnames
c1_idx <- 1
c2_idx <- 1
idx <- 1
for(x in tmp_model$cluster)
{
if(x == 1){
cluster1[c1_idx,] <- wine[idx,]
c1_idx <- c1_idx + 1
}
else{
cluster2[c2_idx,] <- wine[idx,]
c2_idx <- c2_idx + 1
}
idx <- idx + 1
}
cluster1 <- ggplot(cluster1, aes(x=quality, fill=quality)) +
geom_histogram() +
ggtitle('Cluster 1')
cluster2 <- ggplot(cluster2, aes(x=quality, fill=quality)) +
geom_histogram() +
ggtitle('Cluster 2')
grid.arrange(cluster1, cluster2, nrow=1)
# Variable name wine refers to white wine, while redwine explicitly means red wine
# wine.collated means it has both white and red wine in it
# grouped term refers to quality 3-6 combined as low and 7-9 combined as high
# We use wine.orig to capture since quality in wine.orig is numeric instead of factors
bad <- wine[wine.orig[,'quality'] <= 5,]
good <- wine[wine.orig[,'quality'] > 5,]
bad$quality <- 'low'
good$quality <- 'high'
bad$quality <- as.factor(bad$quality)
good$quality <- as.factor(good$quality)
wine.grouped <- rbind(bad, good)
wine.grouped <- cbind(wine.grouped, rep('white', nrow(wine.grouped)))
cnames_wtype <- c(cnames, 'wine.type')
colnames(wine.grouped) <- cnames_wtype
# Since doing this at a later stage, I wish all analyses will reflect on this
# grouped data from this point onward.
wine <- wine.grouped
bad.redwine <- redwine[redwine.orig[,'quality'] <= 6,]
good.redwine <- redwine[redwine.orig[,'quality'] > 6,]
bad.redwine$quality <- 'low'
good.redwine$quality <- 'high'
bad.redwine$quality <- as.factor(bad.redwine$quality)
good.redwine$quality <- as.factor(good.redwine$quality)
redwine.grouped <- rbind(bad.redwine, good.redwine)
redwine.grouped <- cbind(redwine.grouped, rep('red', nrow(redwine.grouped)))
colnames(redwine.grouped) <- cnames_wtype
redwine <- redwine.grouped
wine.collated.grouped <- rbind(wine.grouped, redwine.grouped)
wine.collated.grouped$wine.type <- as.factor(wine.collated.grouped$wine.type)
# , fig.width=11, fig.height=4
bp.al <- ggplot(wine, aes(x=quality, y=alcohol, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab("Alcohol level %") +
ggtitle('Alcohol level found in different quality levels of white wine')
bp.al
sp.al_rs <- ggplot(wine.grouped, aes(x=alcohol, y=residual.sugar, color=quality)) +
geom_point(alpha=0.5) +
xlab('Alcohol level') +
ylab('Residual Sugar') +
ggtitle('Correlation between alcohol and residual sugar levels') +
ylim(0, 26)
theme(legend.position='left')
sp.al_rs <- ggMarginal(sp.al_rs, type='boxplot', fill='darkgray')
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level found in different quality levels of wine')
grid.arrange(sp.al_rs, bp.rs, nrow=1)
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
bp.rs.red <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red Wine')
bp.rs.r.w <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red and White')
grid.arrange(bp.rs, bp.rs.red, bp.rs.r.w, nrow=1)
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
bp.rs.red <- ggplot(redwine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red Wine')
bp.rs.r.w <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=residual.sugar, color=wine.type, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red and White')
grid.arrange(bp.rs, bp.rs.red, bp.rs.r.w, nrow=1)
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
bp.rs.red <- ggplot(redwine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red Wine')
bp.rs.r.w <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=residual.sugar, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red and White')
grid.arrange(bp.rs, bp.rs.red, bp.rs.r.w, nrow=1)
