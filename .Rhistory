str(wine.collated)
%>%
wine.collated %>% filter_by()
library(tidyverse)
install.package('tidyverse')
install.packages('tidyverse')
library(tidyverse)
by_wt_q <- wine.collected %>% group_by(wine.type+quality)
by_wt_q <- wine.collated %>% group_by(wine.type+quality)
by_wt <- wine.collated %>% group_by(wine.type)
by_wt_q <- by_wt %>% group_by(quality)
by_wt_q %>% summarise(pH = mean(pH),
)
by_wt_q
res <- by_wt_q %>% summarise(pH = mean(pH))
res
by_quality <- wine1 %>% group_by(quality)
wine1.summary <- by_quality %>% summarise(pH = mean(pH))
by_quality <- wine2 %>% group_by(quality)
wine2.summary <- by_quality %>% summarise(pH = mean(pH))
wine1.summary
wine2.summary
wine2.summary <- by_quality %>% summarise(pH = mean(pH),
wine.type = wine.type)
wine1.summary
by_quality <- wine1 %>% group_by(quality)
wine1.summary <- by_quality %>% summarise(pH = mean(pH))
wine1.summary <- cbind(wine1.summary, rep('white', nrow(wine1.summary)))
colnames(wine1.summary) <- c('pH', 'wine.type')
by_quality <- wine2 %>% group_by(quality)
wine2.summary <- by_quality %>% summarise(pH = mean(pH))
wine2.summary <- cbind(wine2.summary, rep('red', nrow(wine2.summary)))
colnames(wine2.summary) <- c('pH', 'wine.type')
wine1.summary
wine2.summary
by_quality <- wine1 %>% group_by(quality)
wine1.summary <- by_quality %>% summarise(pH = mean(pH))
wine1.summary <- cbind(wine1.summary, rep('white', nrow(wine1.summary)))
colnames(wine1.summary) <- c('pH', 'wine.type')
by_quality <- wine2 %>% group_by(quality)
wine2.summary <- by_quality %>% summarise(pH = mean(pH))
wine2.summary <- cbind(wine2.summary, rep('red', nrow(wine2.summary)))
colnames(wine2.summary) <- c('pH', 'wine.type')
wine.summary <- rbind(wine1.summary, wine2.summary)
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar()
ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type)) +
geom_bar()
ggplot(wine.summary, aes(x=quality, y=pH)) +
geom_bar()
wine.summary
wine1.summary
by_quality %>% summarise(pH = mean(pH))
by_quality <- wine1 %>% group_by(quality)
wine1.summary <- by_quality %>% summarise(pH = mean(pH))
wine1.summary <- cbind(wine1.summary, rep('white', nrow(wine1.summary)))
colnames(wine1.summary) <- c('quality', 'pH', 'wine.type')
by_quality <- wine2 %>% group_by(quality)
wine2.summary <- by_quality %>% summarise(pH = mean(pH))
wine2.summary <- cbind(wine2.summary, rep('red', nrow(wine2.summary)))
colnames(wine2.summary) <- c('quality', 'pH', 'wine.type')
wine.summary <- rbind(wine1.summary, wine2.summary)
wine.summary
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar()
ggplot(wine.summary, aes(x=quality, y=pH)) +
geom_bar(fill=wine.type)
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity")
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="stack", stat="identity")
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity")
help(geom_bar)
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
wine2.summary
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type)) +
geom_point()
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type)) +
geom_point() +
geom_line()
ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type, color=wine.type)) +
geom_point() +
geom_line()
grid.arrange(grouped_bar, line_plot, nrow=1)
grouped_bar <- ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
line_plot <- ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type, color=wine.type)) +
geom_point() +
geom_line()
grid.arrange(grouped_bar, line_plot, nrow=1)
grouped_bar <- ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
line_plot <- ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type, color=wine.type)) +
geom_point() +
geom_line()
grid.arrange(grouped_bar, line_plot, nrow=1)
hist(wine$quality)
hist(as.character(wine$quality))
hist(as.numeric(wine$quality))
hist(as.numeric(wine$quality))
ggplot(wine.collated, aes(x=wine.type, y=alcohol, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level distribution') +
ggtitle('Alcohol level in red and white wines')
ggplot(wine.collated, aes(x=wine.type, y=alcohol, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level distribution') +
ggtitle('Alcohol level in red and white wines')
ggplot(wine, aes(x=alcohol, y=pH))+
geom_point()
cor(wine$alcohol, wine$pH)
ggplot(wine, aes(x=alcohol, y=pH))+
geom_point()
cor(wine$alcohol, wine$pH)
ggplot(redwine, aes(quality)) +
geom_bar()
summary(redwine$quality)
summary(wine$quality)
str(wine)
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
corrplot(cor(wine[, acidity_cnames]),
upper='number',
type='upper')
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
corrplot(cor(wine[, acidity_cnames]),
upper='number',
type='upper')
corrplot(cor(wine[, acidity_cnames]),
type='upper',
upper='number')
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot(cor(tmp_wine),
type='upper',
upper='number')
help(corrplot)
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot(cor(tmp_wine),
type='upper',
umethod='number')
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot(cor(tmp_wine),
type='upper',
method='number')
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot(cor(tmp_wine),
type='upper',
method='number')
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot(cor(tmp_wine),
type='upper',
method='number')
cor
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot::corrplot(cor(tmp_wine),
type='upper',
method='number')
cor
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot::corrplot(cor(tmp_wine),
type='upper',
method='number')
plot(cor)
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot(cor(tmp_wine),
type='upper',
method='number')
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
corrplot(cor(wine[, acidity_cnames]),
type='upper',
method='number')
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
corrplot(cor(wine[, acidity_cnames]),
type='upper',
method='ellipse')
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
corrplot(cor(wine[, acidity_cnames]),
type='upper',
method='circle')
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
corrplot(cor(wine[, acidity_cnames]),
type='upper',
method='number')
bp.fa <- ggplot(wine, aes(x=quality, y=fixed.acidity, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Fixed Acidity level') +
ggtitle('Fixed Acidity level found in different quality levels of wine')
bp.fa
summary(wine$quality)
t.test(wine$alcohol, conf.level = 0.95)
t.test(redwine$alcohol, conf.level=0.95)
ggplot(wine.collated, aes(x=wine.type, y=pH)) +
geom_boxplot(color=wine.type) +
stat_boxplot(geom='errorbar')
str(wine.collated)
ggplot(wine.collated, aes(x=wine.type, y=pH)) +
geom_boxplot()
ggplot(wine.collated, aes(x=wine.type, y=pH)) +
geom_boxplot(color=wine.type)
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
bp.ph.white <- ggplot(wine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white wine')
bp.ph.red <-   ggplot(redwine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in red wine')
grid.arrange(bp.ph.white, bp.ph.red, nrow=1)
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
bp.ph.white <- ggplot(wine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white wine')
bp.ph.red <-   ggplot(redwine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in red wine')
grid.arrange(bp.ph.white, bp.ph.red, nrow=1)
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
bp.ph.white <- ggplot(wine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white wine')
bp.ph.red <-   ggplot(redwine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in red wine')
grid.arrange(bp.ph.white, bp.ph.red, nrow=1)
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
ggplot(wine.collated, aes(x=quality, y=pH, color=wine.type)) +
geom_point() +
xlab('Quality level') +
ylab('pH level') +
ggtitle('How pH level is associated to quality')
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
bp.ph.white <- ggplot(wine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white wine')
bp.ph.white
# bp.ph.red <-   ggplot(redwine, aes(x=quality, y=pH, color=quality)) +
#                geom_boxplot(outlier.shape=8, outlier.color='red') +
#                stat_boxplot(geom='errorbar') +
#                xlab('Quality') +
#                ylab('pH') +
#                ggtitle('Distribution of pH level in red wine')
#
# grid.arrange(bp.ph.white, bp.ph.red, nrow=1)
#fig.width=11, fig.height=4
bp.ph.white <- ggplot(wine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white wine')
bp.ph.white
# bp.ph.red <-   ggplot(redwine, aes(x=quality, y=pH, color=quality)) +
#                geom_boxplot(outlier.shape=8, outlier.color='red') +
#                stat_boxplot(geom='errorbar') +
#                xlab('Quality') +
#                ylab('pH') +
#                ggtitle('Distribution of pH level in red wine')
#
# grid.arrange(bp.ph.white, bp.ph.red, nrow=1)
lm(quality ~ pH, data=wine)
tmp_model <- lm(quality ~ pH, data=wine)
summary(tmp_model)
help(glm)
multinom(quality~pH, data=wine)
library(nnet)
multinom(quality~pH, data=wine)
tmp_model <_ multinom(quality~pH, data=wine)
tmp_model <- multinom(quality~pH, data=wine)
library(cars)
library(car)
vif
help(cif)
help(vif)
library(faraway)
vif(tmp_model)
# wine.1 represents white wine dataset
by_quality <- wine1 %>% group_by(quality)
wine1.summary <- by_quality %>% summarise(pH = mean(pH))
wine1.summary <- cbind(wine1.summary, rep('white', nrow(wine1.summary)))
colnames(wine1.summary) <- c('quality', 'pH', 'wine.type')
# wine.2 represents red wine dataset
by_quality <- wine2 %>% group_by(quality)
wine2.summary <- by_quality %>% summarise(pH = mean(pH))
wine2.summary <- cbind(wine2.summary, rep('red', nrow(wine2.summary)))
colnames(wine2.summary) <- c('quality', 'pH', 'wine.type')
# combine white and red wine dataset together
wine.summary <- rbind(wine1.summary, wine2.summary)
grouped_bar <- ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
line_plot <- ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type, color=wine.type)) +
geom_point() +
geom_line()
grid.arrange(grouped_bar, line_plot, nrow=1)
grouped_bar <- ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
line_plot <- ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type, color=wine.type)) +
geom_point() +
geom_line()
grid.arrange(grouped_bar, line_plot, nrow=1)
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
corrplot(cor(wine[, acidity_cnames]),
type='upper',
method='number')
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
cplot <- corrplot(cor(wine[, acidity_cnames]),
type='upper',
method='number')
summary(wine[, acidity_cnames])
xkablesummary(wine)
knitr::opts_chunk$set(warning=F, results='hide', message=F)
library(ggplot2)
library(ggExtra)
library(gridExtra)
library(ezids)
library(lattice)
library(corrplot)
library(tidyverse)
wine <- read.csv(file='winequality-white.csv',
header=T,
sep=";",
fill=T,
strip.white=T,
blank.lines.skip=T,
colClasses = c('quality'='factor'))
cnames <- colnames(wine)
cnames_ind <- head(cnames, length(cnames)-1)
wine_ind <- wine[, cnames_ind]
redwine <- read.csv(file='winequality-red.csv',
header=T,
sep=";",
fill=T,
strip.white=T,
blank.lines.skip=T,
colClasses = c('quality'='factor'))
show(str(wine))
# May be we should start using bar instead of histogram as this looks so ugly
ggplot(wine, aes(quality)) +
geom_bar(color='white', alpha=0.7) +
xlab('Quality') +
ylab('Frequency rate') +
labs('Quality distribution')
pairs(wine)
tmp_wine <- wine[wine[, 'quality']==9,]
quality_index <- which(colnames(tmp_wine)=='quality')
tmp_wine <- tmp_wine[, -quality_index]
cor <- corrplot(cor(tmp_wine),
type='upper',
method='number')
# , fig.width=11, fig.height=4
bp.al <- ggplot(wine, aes(x=quality, y=alcohol, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Alcohol level') +
ggtitle('Alcohol level found in different quality levels of wine')
bp.al
sp.al_rs <- ggplot(wine, aes(x=alcohol, y=residual.sugar, color=quality)) +
geom_point(alpha=0.5) +
xlab('Alcohol level') +
ylab('Residual Sugar') +
ggtitle('Correlation between alcohol and residual sugar levels') +
theme(legend.position='left')
sp.al_rs <- ggMarginal(sp.al_rs, type='boxplot', fill='darkgray')
bp.rs <- ggplot(wine, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level found in different quality levels of wine')
grid.arrange(sp.al_rs, bp.rs, nrow=1)
wine.colnames <- colnames(wine)
wine.colnames <- c(wine.colnames, 'wine.type')
wine1 <- cbind(wine, rep('white', nrow(wine)))
colnames(wine1) <- wine.colnames
wine2 <- cbind(redwine, rep('red', nrow(redwine)))
colnames(wine2) <- wine.colnames
wine.collated <- rbind(wine1, wine2)
sp.al_rs <- ggplot(wine.collated, aes(x=alcohol, y=residual.sugar, color=wine.type)) +
geom_point() +
xlab('Alcohol level') +
ylab('Residual Sugar level') +
ggtitle('Correlation between alcohol and residual sugar level in white & red wines')
sp.al_rs
ggplot(wine.collated, aes(x=wine.type, y=alcohol, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level distribution') +
ggtitle('Alcohol level in red and white wines')
ggplot(wine.collated, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot() +
stat_boxplot(geom='errorbar')
#fig.width=11, fig.height=4
bp.ph.white <- ggplot(wine, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white wine')
bp.ph.white
# bp.ph.red <-   ggplot(redwine, aes(x=quality, y=pH, color=quality)) +
#                geom_boxplot(outlier.shape=8, outlier.color='red') +
#                stat_boxplot(geom='errorbar') +
#                xlab('Quality') +
#                ylab('pH') +
#                ggtitle('Distribution of pH level in red wine')
#
# grid.arrange(bp.ph.white, bp.ph.red, nrow=1)
# wine.1 represents white wine dataset
by_quality <- wine1 %>% group_by(quality)
wine1.summary <- by_quality %>% summarise(pH = mean(pH))
wine1.summary <- cbind(wine1.summary, rep('white', nrow(wine1.summary)))
colnames(wine1.summary) <- c('quality', 'pH', 'wine.type')
# wine.2 represents red wine dataset
by_quality <- wine2 %>% group_by(quality)
wine2.summary <- by_quality %>% summarise(pH = mean(pH))
wine2.summary <- cbind(wine2.summary, rep('red', nrow(wine2.summary)))
colnames(wine2.summary) <- c('quality', 'pH', 'wine.type')
# combine white and red wine dataset together
wine.summary <- rbind(wine1.summary, wine2.summary)
grouped_bar <- ggplot(wine.summary, aes(x=quality, y=pH, fill=wine.type)) +
geom_bar(position="dodge", stat="identity") +
ggtitle('Average pH level')
line_plot <- ggplot(wine.summary, aes(x=quality, y=pH, group=wine.type, color=wine.type)) +
geom_point() +
geom_line()
grid.arrange(grouped_bar, line_plot, nrow=1)
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
cplot <- corrplot(cor(wine[, acidity_cnames]),
type='upper',
method='number')
summary(wine[, acidity_cnames])
bp.fa <- ggplot(wine, aes(x=quality, y=fixed.acidity, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Fixed Acidity level') +
ggtitle('Fixed Acidity level found in different quality levels of wine')
bp.fa
