# For even better clustering, we should consider using more mature
# algorithms such as GMM that clusters datapoints of different statistical
# parameter such as not just mean, but also variance.
# For now, I think this is fine.
tmp_model <- kmeans(wine[, tmp_cnames], centers=2, iter.max = 1000)
ncluster1 <- sum(tmp_model$cluster == 1)
ncluster2 <- sum(tmp_model$cluster == 2)
cluster1 <- data.frame(matrix(nrow=ncluster1, ncol=length(colnames(wine))))
cluster2 <- data.frame(matrix(nrow=ncluster2, ncol=length(colnames(wine))))
colnames(cluster1) <- cnames
colnames(cluster2) <- cnames
c1_idx <- 1
c2_idx <- 1
idx <- 1
for(x in tmp_model$cluster)
{
if(x == 1){
cluster1[c1_idx,] <- wine[idx,]
c1_idx <- c1_idx + 1
}
else{
cluster2[c2_idx,] <- wine[idx,]
c2_idx <- c2_idx + 1
}
idx <- idx + 1
}
cluster1 <- ggplot(cluster1, aes(x=quality, fill=quality)) +
geom_histogram() +
ggtitle('Cluster 1')
cluster2 <- ggplot(cluster2, aes(x=quality, fill=quality)) +
geom_histogram() +
ggtitle('Cluster 2')
grid.arrange(cluster1, cluster2, nrow=1)
# Variable name wine refers to white wine, while redwine explicitly means red wine
# wine.collated means it has both white and red wine in it
# grouped term refers to quality 3-6 combined as low and 7-9 combined as high
# We use wine.orig to capture since quality in wine.orig is numeric instead of factors
bad <- wine[wine.orig[,'quality'] <= 5,]
good <- wine[wine.orig[,'quality'] > 5,]
bad$quality <- 'low'
good$quality <- 'high'
bad$quality <- as.factor(bad$quality)
good$quality <- as.factor(good$quality)
wine.grouped <- rbind(bad, good)
wine.grouped <- cbind(wine.grouped, rep('white', nrow(wine.grouped)))
cnames_wtype <- c(cnames, 'wine.type')
colnames(wine.grouped) <- cnames_wtype
# Since doing this at a later stage, I wish all analyses will reflect on this
# grouped data from this point onward.
wine <- wine.grouped
bad.redwine <- redwine[redwine.orig[,'quality'] <= 6,]
good.redwine <- redwine[redwine.orig[,'quality'] > 6,]
bad.redwine$quality <- 'low'
good.redwine$quality <- 'high'
bad.redwine$quality <- as.factor(bad.redwine$quality)
good.redwine$quality <- as.factor(good.redwine$quality)
redwine.grouped <- rbind(bad.redwine, good.redwine)
redwine.grouped <- cbind(redwine.grouped, rep('red', nrow(redwine.grouped)))
colnames(redwine.grouped) <- cnames_wtype
redwine <- redwine.grouped
wine.collated.grouped <- rbind(wine.grouped, redwine.grouped)
wine.collated.grouped$wine.type <- as.factor(wine.collated.grouped$wine.type)
# , fig.width=11, fig.height=4
bp.al <- ggplot(wine, aes(x=quality, y=alcohol, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab("Alcohol level %") +
ggtitle('Alcohol level found in different quality levels of white wine')
bp.al
summary(outlierKD2(wine, var=alcohol, rm=T, histogram=T)$alcohol)
good.collated.grouped <- wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',]
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
bp.rs.red <- ggplot(redwine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red Wine')
bp.rs.r.w <- ggplot(good.collated.grouped, aes(x=wine.type, y=residual.sugar, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red and White')
grid.arrange(bp.rs, bp.rs.red, bp.rs.r.w, nrow=1)
cor.test(good$alcohol, good$residual.sugar)
cor.test(bad$alcohol, bad$residual.sugar)
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
bp.rs.red <- ggplot(redwine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red Wine')
bp.rs.r.w <- ggplot(good.collated.grouped, aes(x=wine.type, y=residual.sugar, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red and White')
grid.arrange(bp.rs, bp.rs.red, bp.rs.r.w, nrow=1)
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
bp.rs.red <- ggplot(redwine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red Wine')
bp.rs.r.w <- ggplot(good.collated.grouped, aes(x=wine.type, y=residual.sugar, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red and White')
grid.arrange(bp.rs, bp.rs.red, bp.rs.r.w, nrow=1)
sp.al_rs <- ggplot(wine.grouped, aes(x=alcohol, y=residual.sugar, color=quality)) +
geom_point(alpha=0.5) +
xlab('Alcohol level') +
ylab('Residual Sugar') +
ggtitle('Correlation between alcohol and residual sugar levels') +
ylim(0, 26) +
theme(legend.position='left')
sp.al_rs <- ggMarginal(sp.al_rs, type='boxplot', fill='darkgray')
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level found in different quality levels of wine')
grid.arrange(sp.al_rs, bp.rs, nrow=1)
al_rs.model <- lm(residual.sugar~alcohol, data=good.collated.grouped)
alcohol_range <- seq(min(good.collated.grouped$alcohol), max(good.collated.grouped$alcohol), length.out=100)
tmp.df <- data.frame(alcohol=alcohol_range)
pred_rs <- predict(al_rs.model, tmp.df)
tmp.df <- data.frame(alcohol=alcohol_range, residual.sugar=pred_rs)
sp.al_rs <- ggplot(good.collated.grouped, aes(x=alcohol, y=residual.sugar, color=wine.type)) +
geom_point() +
geom_line(data=tmp.df, color='red', lwd=1.1) +
xlab('Alcohol level') +
ylab('Residual Sugar level') +
ggtitle('Correlation between alcohol and residual sugar level in white & red wines')
alc.hist <- ggplot(wine.collated, aes(x=alcohol, y=..density.., fill=wine.type, group=wine.type)) +
geom_histogram(color='white') +
ylab('Frequency rate') +
ggtitle('ALcohol distribution')
grid.arrange(sp.al_rs, alc.hist, nrow=1)
tmp_wine <- NULL # I don't want this to accidentally affect other results
bp.rs <- ggplot(wine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in White Wine')
bp.rs.red <- ggplot(redwine.grouped, aes(x=quality, y=residual.sugar, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red Wine')
bp.rs.r.w <- ggplot(good.collated.grouped, aes(x=wine.type, y=residual.sugar, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Residual sugar level') +
ggtitle('Residual sugar level in Red and White')
grid.arrange(bp.rs, bp.rs.red, bp.rs.r.w, nrow=1)
good.collated.grouped <- wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',]
bad.collated.grouped <- wine.collated.grouped[wine.collated.grouped[, 'quality']=='low',]
str(good.collated.grouped)
unique(good.collated.grouped$quality)
unique(good.collated.grouped$wine.type)
t.test(good.collated.grouped$residual.sugar, mu=mean(bad.collated.grouped$residual.sugar), alternative='greater', conf.level=0.95)
mean(bad.collated.grouped$residual.sugar)
ggplot(wine.collated.grouped, aes(x=quality, y=residual.sugar)) + geom_boxplot()
ggplot(wine.grouped, aes(x=quality, y=residual.sugar)) + geom_boxplot()
summary(good$quality)
summary(good$wine.type)
str(good)
t.test(good$residual.sugar, mu=mean(bad$residual.sugar), alternative='greater', conf.level=0.95)
ggplot(wine.grouped, aes(x=quality, y=residual.sugar)) + geom_boxplot()
mean(bad$residual.sugar)
t.test(good$residual.sugar, mu=mean(bad$residual.sugar), alternative='greater', conf.level=0.95)$pvalue
t.test(good$residual.sugar, mu=mean(bad$residual.sugar), alternative='greater', conf.level=0.95)$p.value
bp.alc.red1 <- ggplot(redwine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in Red Wine')
bp.alc.white1 <- ggplot(wine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in White Wine')
bp.alc.red.white1 <- ggplot(good.collated.grouped, aes(x=wine.type, y=alcohol, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level distribution') +
ggtitle('Alcohol level in red and white wines')
grid.arrange(bp.alc.red1, bp.alc.white1, bp.alc.red.white1, nrow=1)
bp.alc.red1 <- ggplot(redwine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in Red Wine')
bp.alc.white1 <- ggplot(wine.grouped, aes(x=quality, y=alcohol, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level in %') +
ggtitle('Alcohol level in White Wine')
bp.alc.red.white1 <- ggplot(good.collated.grouped, aes(x=wine.type, y=alcohol, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Wine Type') +
ylab('Alcohol level distribution') +
ggtitle('Alcohol level in red and white wines')
grid.arrange(bp.alc.red1, bp.alc.white1, bp.alc.red.white1, nrow=1)
ttest.alc.good.bad <- t.test(good$alcohol, mu=mean(bad$alcohol), alternative='lesser', conf.level=0.95)
ttest.alc.good.bad <- t.test(good$alcohol, mu=mean(bad$alcohol), alternative='less', conf.level=0.95)
ttest.alc.good.bad
mean(bad$alcohol)
ggplot(good.collated.grouped, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.5) +
ggtitle('Distribution of pH level in wine')
bp.ph.white <- ggplot(wine.grouped, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white wine')
bp.ph.red <- ggplot(redwine.grouped, aes(x=quality, y=pH, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in red wine')
tmp.wine.collated.grouped.good <- wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',]
bp.ph.red.white <- ggplot(tmp.wine.collated.grouped.good, aes(x=wine.type, y=pH, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar') +
xlab('Quality') +
ylab('pH') +
ggtitle('Distribution of pH level in white & red')
grid.arrange(bp.ph.white, bp.ph.red, bp.ph.red.white, nrow=1)
ttest.pH.good.bad <- t.test(good$pH, mu=mean(bad$pH), alternative='less', conf.level=0.95)
ttest.pH.good.bad
# wine.1 represents white wine dataset
by_quality <- wine1 %>% group_by(quality)
wine1.summary <- by_quality %>% summarise(pH = mean(pH))
wine1.summary <- cbind(wine1.summary, rep('white', nrow(wine1.summary)))
colnames(wine1.summary) <- c('quality', 'pH', 'wine.type')
# wine.2 represents red wine dataset
by_quality <- wine2 %>% group_by(quality)
wine2.summary <- by_quality %>% summarise(pH = mean(pH))
wine2.summary <- cbind(wine2.summary, rep('red', nrow(wine2.summary)))
colnames(wine2.summary) <- c('quality', 'pH', 'wine.type')
# combine white and red wine dataset together
wine.summary <- rbind(wine1.summary, wine2.summary)
acidity_cnames <- c('fixed.acidity', 'volatile.acidity', 'citric.acid')
cplot <- corrplot(cor(good[, acidity_cnames]),
type='upper',
method='circle')
cplot <- corrplot(cor(good[, acidity_cnames]),
type='upper',
method='number')
cplot <- corrplot(cor(good[, acidity_cnames]),
#type='upper',
method='number')
cplot <- corrplot(cor(good[, acidity_cnames]),
type='upper',
method='circle')
mean(bad$pH)
sulfur_cnames <- c('total.sulfur.dioxide', 'free.sulfur.dioxide', 'sulphates')
s.cplot <- corrplot(cor(wine[, sulfur_cnames]),
type='upper',
method='circle')
bp.fa <- ggplot(wine, aes(x=quality, y=fixed.acidity, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab(TeX('Fixed Acidity level $x 10^{3} mg/L $')) +
ggtitle("Distribution of fixed acidity in white wine")
bp.fa.red <- ggplot(redwine, aes(x=quality, y=fixed.acidity, color=quality, group=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab(TeX('Fixed Acidity level $x 10^{3} mg/L $')) +
ggtitle("Distribution of fixed acidity in red wine")
bp.fa_wr <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=fixed.acidity, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
ggtitle('Distribution of fixed acidity in white and red')
grid.arrange(bp.fa.red, bp.fa, bp.fa_wr, nrow=1)
# bp.fa_wr
ttest.fa.good.bad <- t.test(good$fixed.acidity, mu=mean(bad$fixed.acidity))
ttest.fa.good.bad
anova.fa.good.bad <- aov(fixed.acidity~quality, data=wine.grouped)
anova.fa.good.bad
ttest.fa.good.bad <- t.test(good$fixed.acidity, mu=mean(bad$fixed.acidity))
ttest.fa.good.bad
anova.fa.good.bad <- aov(fixed.acidity~quality, data=wine.grouped)
anova.fa.good.bad
summary(anova.fa.good.bad)
help(aov)
ind_cnames <- colnames(wine)
ind_cnames <- ind_cnames[1:(length(ind_cnames)-2)]
corrplot(cor(wine.orig[, ind_cnames]),
type='upper',
method='circle')
ind_cnames <- colnames(good)
ind_cnames <- ind_cnames[1:(length(ind_cnames)-2)]
corrplot(cor(wine.orig[, ind_cnames]),
type='upper',
method='circle')
ind_cnames <- colnames(wine)
ind_cnames <- colnames(wine)
ind_cnames <- ind_cnames[1:(length(ind_cnames)-2)]
corrplot(cor(wine.orig[, ind_cnames]),
type='upper',
method='circle')
str(good)
ind_cnames <- colnames(good)
ind_cnames <- ind_cnames[1:(length(ind_cnames)-1)]
corrplot(cor(good[, ind_cnames]),
type='upper',
method='circle')
bp.va <- ggplot(wine, aes(x=quality, y=volatile.acidity, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Volatile Acidity level') +
#ylim(0.05, 1) +
ggtitle('Volatile Acidity level in White Wine')
bp.va.red <- ggplot(redwine, aes(x=quality, y=volatile.acidity, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Volatile Acidity level') +
# ylim(0.05, 1) +
ggtitle('Volatile Acidity in Red Wine')
bp.va.red.white <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=volatile.acidity, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Volatile Acidity level') +
# ylim(0.05, 1) +
ggtitle('Volatile Acidity in Red & White')
grid.arrange(bp.va, bp.va.red, bp.va.red.white, nrow=1)
summary(good)
t.test(good$volatile.acidity, mu=mean(bad$volatile.acidity), alternative='greater')
t.test(good$volatile.acidity, conf.level=0.95)
ttest.fa.good.bad <- t.test(good$fixed.acidity, mu=mean(bad$fixed.acidity), var.equal=F)
ttest.fa.good.bad
anova.fa.good.bad <- aov(fixed.acidity~quality, data=wine.grouped)
anova.fa.good.bad
summary(anova.fa.good.bad)
help(t.test)
t.test(good$fixed.acidity, mu=mean(bad$fixed.acidity), var.equal=T)
bp.ca <- ggplot(wine.grouped, aes(x=quality, y=citric.acid, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Citric Acid level') +
ggtitle('Citric Acid in White Wine')
bp.ca.red <- ggplot(redwine.grouped, aes(x=quality, y=citric.acid, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Citric Acid level') +
ggtitle('Citric Acid in Red Wine')
bp.ca.red.white <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=citric.acid, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Citric Acid level') +
ggtitle('Citric Acid in Red and White')
grid.arrange(bp.ca, bp.ca.red, bp.ca.red.white, nrow=1)
t.test(good$citric.acid, mu=mean(bad$citric.acid), var.equal=F)
bp.ch <- ggplot(wine.grouped, aes(x=quality, y=chlorides, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Chloride level') +
ggtitle('Chloride level in White Wine')
bp.ch.red <- ggplot(redwine.grouped, aes(x=quality, y=chlorides, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Chloride level') +
ggtitle('Chloride level in Red Wine')
bp.ch.red.white <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=chlorides, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality level') +
ylab('Chloride level') +
ggtitle('Chloride level in White and Red')
grid.arrange(bp.ch, bp.ch.red, bp.ch.red.white, nrow=1)
ttest.fa.good.bad <- t.test(good$fixed.acidity, bad$fixed.acidity, var.equal=F)
ttest.fa.good.bad
anova.fa.good.bad <- aov(fixed.acidity~quality, data=wine.grouped)
anova.fa.good.bad
summary(anova.fa.good.bad)
ttest.chloride.good.bad <- t.test(good$chlorides, mu=mean(bad$chlorides), alternative='greater')
ttest.chloride.good.bad
ttest.alc.good.bad <- t.test(good$alcohol, mu=mean(bad$alcohol), alternative='less', conf.level=0.95)
ttest.alc.good.bad
bp.density.w.quality <- ggplot(wine, aes(x=quality, y=density, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Density') +
# ylim(0.985, 1.005) +
ggtitle('Density in White Wine')
bp.density.r.quality <- ggplot(redwine, aes(x=quality, y=density, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Density') +
# ylim(0.985, 1.005) +
ggtitle('Density in Red Wine')
bp.density <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=density, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Wine Type') +
ylab('Density') +
# ylim(0.985, 1.005) +
ggtitle('How density is distributed in red and white wine')
# bp.density
grid.arrange(bp.density.w.quality, bp.density.r.quality, bp.density, nrow=1)
mean(bad$chlorides)
ttest.citric.good.bad <- t.test(good$citric.acid, bad$citric.acid, var.equal=F)
ttest.citric.good.bad
ggplot(wine, aes(x=alcohol, y=density, color=quality)) +
geom_point() +
ylim(0.984, 1.005)
ggtitle('How density and alcohol are correlated')
bp.sul.w <- ggplot(wine, aes(x=quality, y=sulphates, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Sulphates') +
# ylim(0.985, 1.005) +
ggtitle('Sulphates in White Wine')
bp.sul.r <- ggplot(redwine, aes(x=quality, y=sulphates, color=quality)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Quality') +
ylab('Sulphates') +
# ylim(0.985, 1.005) +
ggtitle('Sulphates in Red Wine')
bp.sul <- ggplot(wine.collated.grouped[wine.collated.grouped[, 'quality']=='high',], aes(x=wine.type, y=sulphates, color=wine.type)) +
geom_boxplot(outlier.shape=8, outlier.color='red') +
stat_boxplot(geom='errorbar', width=0.3) +
xlab('Wine Type') +
ylab('Sulphates') +
# ylim(0.985, 1.005) +
ggtitle('Sulphates in red and white wine')
grid.arrange(bp.sul.w, bp.sul.r, bp.sul, nrow=1)
ttest.sulphates.good.bad <- t.test(good$sulphates, bad$sulphates, var.equal=F)
ttest.sulphates.good.bad
aov.volatile.acidity_winetype <- aov(volatile.acidity~wine.type, data=wine.collated.grouped)
summary(aov.volatile.acidity_winetype)
aov.density_winetype <- aov(density~wine.type, data=wine.collated.grouped)
summary(aov.density_winetype)
TukeyHSD(aov.density_winetype)
ttest.density.red.white <- t.test(good$density, mu=mean(good.redwine$density), alternative='less')
ttest.density.red.white
ttest.density.red.white <- t.test(good$density, mu=mean(good.redwine$density), alternative='greater')
ttest.density.red.white
test.model <- glm(quality ~ ., data=wine.grouped[-length(colnames(wine.grouped))], family='binomial')
summary(test.model)
model1 <- glm(quality ~ alcohol, data=wine.grouped, family='binomial')
summary(model1)
model2 <- glm(quality ~ alcohol+chlorides, data=wine.grouped, family='binomial')
summary(model2)
xkablevif(model2)
model3 <- glm(quality ~ alcohol+chlorides+free.sulfur.dioxide, data=wine.grouped, family='binomial')
summary(model3)
xkablevif(model3)
model4 <- glm(quality ~ alcohol+chlorides+residual.sugar, data=wine.grouped, family='binomial')
summary(model4)
xkablevif(model4)
model5 <- glm(quality ~ alcohol+chlorides+sulphates, data=wine.grouped, family='binomial')
summary(model5)
xkablevif(model5)
model6 <- glm(quality ~ alcohol+chlorides+sulphates+pH, data=wine.grouped, family='binomial')
summary(model6)
xkablevif(model6)
an.md <- anova(model1, model2, model5, model6)
an.md
summary(an.md)
